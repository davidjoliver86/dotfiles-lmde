---
  - name: chrome apt key
    become: true
    shell:
      cmd: curl https://dl.google.com/linux/linux_signing_key.pub | gpg --dearmor -o /etc/apt/keyrings/google-chrome-archive-keyring.pgp
      creates: /etc/apt/keyrings/google-chrome-archive-keyring.pgp

  - name: chrome apt repo
    become: true
    ansible.builtin.apt_repository:
      repo: deb [arch=amd64 signed-by=/etc/apt/keyrings/google-chrome-archive-keyring.pgp] https://dl.google.com/linux/chrome/deb/ stable main
      state: present
      filename: google-chrome

  - name: chrome apt repo - ensure the not-signed-by is absent
    become: true
    ansible.builtin.apt_repository:
      repo: deb [arch=amd64] https://dl.google.com/linux/chrome/deb/ stable main
      state: absent
      filename: google-chrome

  - name: install chrome
    become: true
    apt:
      name: google-chrome-stable
      update_cache: true
